


FILE USAGE DAEMON AS AUDISPD PLUGIN
===================================

This is an ordinary audispd plugin.

It's code is originating from
  "audit-2.8.2/contrib/plugin/audisp-example.c"


INSTALLATION
------------

Copy executable fusgd to an appropriate location such as this:

> sudo cp fusgd /sbin/fusgd

Executable fusgd has to be owned by root. Check with

> sudo ls -l /sbin/fusgd

Next, copy the configuration into the plugin.d folder of audispd.
NOTE: Location of the folder can differe, see man audispd.conf.

> sudo cp fusgd.conf /etc/audisp/plugin.d/.

Review the configuration of auditd and make sure, audispd is actually 
active.

> sudo vi /etc/audit/auditd.conf

  Must contain the following line:
  
  dispatcher = /sbin/audispd
  

Finally restart auditd to make changes happen.

> sudo systemctl restart auditd



DEBUGGING:
----------

fusgd supports a debug mode for development purposes, 
where it reads auditing events from a file

    /tmp/test.log
    
This file can be created with the following command:

    sudo ausearch --start today --raw > /tmp/test.log



Audit Event Format (string):
----------------------------

event:  record+
record: '(' timestamp ':' serial ')' type_field field+
type_field: 'type=' audit_type_name
field:  name '=' value
name:   string
value:  string
string: // utf-8?